name: beneficium_sleep
services:
  nginx:
    build:
      context: docker/prod/nginx
      dockerfile: Dockerfile
    volumes:
      - ./../source:/var/www
    ports:
      - '8081:80'
      - '8444:443'
      - '2522:22'
    links:
      - php-fpm

  php-fpm:
    build:
      context: docker/prod/php-fpm
      dockerfile: Dockerfile
    volumes:
      - ./../source:/var/www
    environment:
      REDIS_PORT: "${REDIS_PORT}"
      REDIS_HOST: "${REDIS_HOST}"
    links:
      - mysql2

  mysql2:
    image: mysql:8.0
    volumes:
      - ./DBDocker:/var/lib/mysql
    environment:
      MYSQL_ROOT_PASSWORD: "${MYSQL_ROOT_PASSWORD}"
      MYSQL_USER: "${MYSQL_USER}"
      MYSQL_PASSWORD: "${MYSQL_PASSWORD}"
      MYSQL_DATABASE: "${MYSQL_DATABASE}"
    ports:
      - "${DB_PORT}:3306"

  redis:
    image: redis:latest
    ports:
      - "${REDIS_PORT}:6379"